from scapy.all import IP, ICMP, sr
from typing import List

class NetworkScanner:
    def __init__(self, network: str):
        self.network = network

    def ping_sweep(self) -> List[str]:
        print(f"Scanning network: {self.network}")
        
        # Perform the scan
        ans, _ = sr(IP(dst=self.network)/ICMP(), timeout=3)

        # Collect results
        results = [r.src for s, r in ans]
        return results

# network = '10.8.0.0/24'
# netscan = NetworkScanner(network)
# ips = netscan.ping_sweep()
# print(ips)
